# ---------------------------------------------------------
# Copyright (c) Microsoft Corporation. All rights reserved.
# ---------------------------------------------------------
import json
import logging
import os
import pickle
import numpy as np
import pandas as pd
import joblib

import azureml.automl.core
from azureml.automl.core.shared import logging_utilities, log_server
from azureml.telemetry import INSTRUMENTATION_KEY

from inference_schema.schema_decorators import input_schema, output_schema
from inference_schema.parameter_types.numpy_parameter_type import NumpyParameterType
from inference_schema.parameter_types.pandas_parameter_type import PandasParameterType


input_sample = pd.DataFrame({"URL_LENGTH": pd.Series([0.0], dtype="float64"), "NUMBER_SPECIAL_CHARACTERS": pd.Series([0.0], dtype="float64"), "TCP_CONVERSATION_EXCHANGE": pd.Series([0.0], dtype="float64"), "DIST_REMOTE_TCP_PORT": pd.Series([0.0], dtype="float64"), "REMOTE_IPS": pd.Series([0.0], dtype="float64"), "APP_BYTES": pd.Series([0.0], dtype="float64"), "SOURCE_APP_PACKETS": pd.Series([0.0], dtype="float64"), "REMOTE_APP_PACKETS": pd.Series([0.0], dtype="float64"), "SOURCE_APP_BYTES": pd.Series([0.0], dtype="float64"), "REMOTE_APP_BYTES": pd.Series([0.0], dtype="float64"), "APP_PACKETS": pd.Series([0.0], dtype="float64"), "CH_iso-8859": pd.Series([0], dtype="int64"), "CH_iso-8859-1": pd.Series([0], dtype="int64"), "CH_none": pd.Series([0], dtype="int64"), "CH_us-ascii": pd.Series([0], dtype="int64"), "CH_utf-8": pd.Series([0], dtype="int64"), "CH_windows-1251": pd.Series([0], dtype="int64"), "CH_windows-1252": pd.Series([0], dtype="int64"), "SV_.v01 apache": pd.Series([0], dtype="int64"), "SV_294": pd.Series([0], dtype="int64"), "SV_aeria games & entertainment": pd.Series([0], dtype="int64"), "SV_akamaighost": pd.Series([0], dtype="int64"), "SV_amazons3": pd.Series([0], dtype="int64"), "SV_apache": pd.Series([0], dtype="int64"), "SV_apache-coyote/1.1": pd.Series([0], dtype="int64"), "SV_apache/1.3.27 (unix)  (red-hat/linux) mod_perl/1.26 php/4.3.3 frontpage/5.0.2 mod_ssl/2.8.12 openssl/0.9.6b": pd.Series([0], dtype="int64"), "SV_apache/1.3.27 (unix) php/4.4.1": pd.Series([0], dtype="int64"), "SV_apache/1.3.31 (unix) php/4.3.9 mod_perl/1.29 rus/pl30.20": pd.Series([0], dtype="int64"), "SV_apache/1.3.33 (unix) mod_ssl/2.8.24 openssl/0.9.7e-p1 php/4.4.8": pd.Series([0], dtype="int64"), "SV_apache/1.3.34 (unix) php/4.4.4": pd.Series([0], dtype="int64"), "SV_apache/1.3.37 (unix) mod_perl/1.29 mod_ssl/2.8.28 openssl/0.9.7e-p1": pd.Series([0], dtype="int64"), "SV_apache/1.3.39 (unix) php/5.2.5 mod_auth_passthrough/1.8 mod_bwlimited/1.4 mod_log_bytes/1.2 mod_gzip/1.3.26.1a frontpage/5.0.2.2635 dav/1.0.3 mod_ssl/2.8.30 openssl/0.9.7a": pd.Series([0], dtype="int64"), "SV_apache/1.3.42 ben-ssl/1.60 (unix) mod_gzip/1.3.26.1a mod_fastcgi/2.4.6 mod_throttle/3.1.2 chili!soft-asp/3.6.2 frontpage/5.0.2.2635 mod_perl/1.31 php/4.4.9": pd.Series([0], dtype="int64"), "SV_apache/2": pd.Series([0], dtype="int64"), "SV_apache/2.0.52 (red hat)": pd.Series([0], dtype="int64"), "SV_apache/2.0.63 (unix) mod_ssl/2.0.63 openssl/0.9.8e-fips-rhel5 mod_auth_passthrough/2.1 mod_bwlimited/1.4 php/5.3.6": pd.Series([0], dtype="int64"), "SV_apache/2.2.0 (fedora)": pd.Series([0], dtype="int64"), "SV_apache/2.2.10 (linux/suse)": pd.Series([0], dtype="int64"), "SV_apache/2.2.11 (unix) php/5.2.6": pd.Series([0], dtype="int64"), "SV_apache/2.2.13 (unix) mod_ssl/2.2.13 openssl/0.9.8e-fips-rhel5 mod_auth_passthrough/2.1 mod_bwlimited/1.4 php/5.2.10": pd.Series([0], dtype="int64"), "SV_apache/2.2.14 (freebsd) mod_ssl/2.2.14 openssl/0.9.8y dav/2 php/5.2.12 with suhosin-patch": pd.Series([0], dtype="int64"), "SV_apache/2.2.14 (ubuntu)": pd.Series([0], dtype="int64"), "SV_apache/2.2.14 (unix) mod_ssl/2.2.14 openssl/0.9.8a": pd.Series([0], dtype="int64"), "SV_apache/2.2.14 (unix) mod_ssl/2.2.14 openssl/0.9.8e-fips-rhel5": pd.Series([0], dtype="int64"), "SV_apache/2.2.15 (centos)": pd.Series([0], dtype="int64"), "SV_apache/2.2.15 (centos) dav/2 mod_ssl/2.2.15 openssl/1.0.1e-fips php/5.3.3": pd.Series([0], dtype="int64"), "SV_apache/2.2.15 (red hat)": pd.Series([0], dtype="int64"), "SV_apache/2.2.16 (debian)": pd.Series([0], dtype="int64"), "SV_apache/2.2.16 (unix) mod_ssl/2.2.16 openssl/0.9.8e-fips-rhel5 mod_auth_passthrough/2.1 mod_bwlimited/1.4": pd.Series([0], dtype="int64"), "SV_apache/2.2.20 (unix)": pd.Series([0], dtype="int64"), "SV_apache/2.2.21 (unix) mod_ssl/2.2.21 openssl/0.9.8e-fips-rhel5 php/5.3.10": pd.Series([0], dtype="int64"), "SV_apache/2.2.22": pd.Series([0], dtype="int64"), "SV_apache/2.2.22 (debian)": pd.Series([0], dtype="int64"), "SV_apache/2.2.22 (debian) mod_python/3.3.1 python/2.7.3 mod_ssl/2.2.22 openssl/1.0.1t": pd.Series([0], dtype="int64"), "SV_apache/2.2.22 (ubuntu)": pd.Series([0], dtype="int64"), "SV_apache/2.2.23 (amazon)": pd.Series([0], dtype="int64"), "SV_apache/2.2.24 (unix) dav/2 php/5.3.26 mod_ssl/2.2.24 openssl/0.9.8y": pd.Series([0], dtype="int64"), "SV_apache/2.2.25 (unix) mod_ssl/2.2.25 openssl/0.9.8e-fips-rhel5 mod_bwlimited/1.4": pd.Series([0], dtype="int64"), "SV_apache/2.2.26 (unix) mod_ssl/2.2.26 openssl/0.9.8e-fips-rhel5 mod_bwlimited/1.4 php/5.4.26": pd.Series([0], dtype="int64"), "SV_apache/2.2.26 (unix) mod_ssl/2.2.26 openssl/1.0.1e-fips dav/2 mod_bwlimited/1.4": pd.Series([0], dtype="int64"), "SV_apache/2.2.27 (centos)": pd.Series([0], dtype="int64"), "SV_apache/2.2.27 (unix) openam web agent/4.0.1-1 mod_ssl/2.2.27 openssl/1.0.1p php/5.3.28": pd.Series([0], dtype="int64"), "SV_apache/2.2.29 (amazon)": pd.Series([0], dtype="int64"), "SV_apache/2.2.29 (unix) mod_ssl/2.2.29 openssl/1.0.1e-fips dav/2 mod_bwlimited/1.4": pd.Series([0], dtype="int64"), "SV_apache/2.2.29 (unix) mod_ssl/2.2.29 openssl/1.0.1e-fips mod_bwlimited/1.4": pd.Series([0], dtype="int64"), "SV_apache/2.2.29 (unix) mod_ssl/2.2.29 openssl/1.0.1e-fips mod_bwlimited/1.4 php/5.4.35": pd.Series([0], dtype="int64"), "SV_apache/2.2.3 (centos)": pd.Series([0], dtype="int64"), "SV_apache/2.2.3 (red hat)": pd.Series([0], dtype="int64"), "SV_apache/2.2.31 (amazon)": pd.Series([0], dtype="int64"), "SV_apache/2.2.31 (centos)": pd.Series([0], dtype="int64"), "SV_apache/2.2.31 (freebsd) php/5.4.15 mod_ssl/2.2.31 openssl/1.0.2d dav/2": pd.Series([0], dtype="int64"), "SV_apache/2.2.31 (unix) mod_ssl/2.2.31 openssl/0.9.8e-fips-rhel5 mod_bwlimited/1.4": pd.Series([0], dtype="int64"), "SV_apache/2.2.31 (unix) mod_ssl/2.2.31 openssl/1.0.1e-fips mod_bwlimited/1.4": pd.Series([0], dtype="int64"), "SV_apache/2.2.31 (unix) mod_ssl/2.2.31 openssl/1.0.1e-fips mod_bwlimited/1.4 mod_fcgid/2.3.9": pd.Series([0], dtype="int64"), "SV_apache/2.2.31 (unix) mod_ssl/2.2.31 openssl/1.0.1e-fips mod_bwlimited/1.4 mod_perl/2.0.8 perl/v5.10.1": pd.Series([0], dtype="int64"), "SV_apache/2.2.32": pd.Series([0], dtype="int64"), "SV_apache/2.4": pd.Series([0], dtype="int64"), "SV_apache/2.4.10": pd.Series([0], dtype="int64"), "SV_apache/2.4.10 (debian)": pd.Series([0], dtype="int64"), "SV_apache/2.4.10 (debian) php/5.6.30-0+deb8u1 mod_perl/2.0.9dev perl/v5.20.2": pd.Series([0], dtype="int64"), "SV_apache/2.4.10 (ubuntu)": pd.Series([0], dtype="int64"), "SV_apache/2.4.10 (unix) openssl/1.0.1k": pd.Series([0], dtype="int64"), "SV_apache/2.4.12 (ubuntu)": pd.Series([0], dtype="int64"), "SV_apache/2.4.12 (unix) openssl/1.0.1e-fips mod_bwlimited/1.4": pd.Series([0], dtype="int64"), "SV_apache/2.4.16 (ubuntu)": pd.Series([0], dtype="int64"), "SV_apache/2.4.17 (unix) openssl/1.0.1e-fips php/5.6.19": pd.Series([0], dtype="int64"), "SV_apache/2.4.18 (ubuntu)": pd.Series([0], dtype="int64"), "SV_apache/2.4.18 (unix) openssl/0.9.8e-fips-rhel5 mod_bwlimited/1.4": pd.Series([0], dtype="int64"), "SV_apache/2.4.18 (unix) openssl/1.0.2e communique/4.1.10": pd.Series([0], dtype="int64"), "SV_apache/2.4.23 (unix)": pd.Series([0], dtype="int64"), "SV_apache/2.4.23 (unix) openssl/0.9.8e-fips-rhel5 mod_bwlimited/1.4": pd.Series([0], dtype="int64"), "SV_apache/2.4.23 (unix) openssl/1.0.1e-fips mod_bwlimited/1.4": pd.Series([0], dtype="int64"), "SV_apache/2.4.25": pd.Series([0], dtype="int64"), "SV_apache/2.4.25 (amazon) openssl/1.0.1k-fips": pd.Series([0], dtype="int64"), "SV_apache/2.4.25 (amazon) php/7.0.14": pd.Series([0], dtype="int64"), "SV_apache/2.4.25 (cpanel) openssl/1.0.1e-fips mod_bwlimited/1.4": pd.Series([0], dtype="int64"), "SV_apache/2.4.25 (debian)": pd.Series([0], dtype="int64"), "SV_apache/2.4.25 (freebsd) openssl/1.0.1s-freebsd php/5.6.30": pd.Series([0], dtype="int64"), "SV_apache/2.4.25 (unix) openssl/1.0.1e-fips mod_bwlimited/1.4": pd.Series([0], dtype="int64"), "SV_apache/2.4.6": pd.Series([0], dtype="int64"), "SV_apache/2.4.6 (centos)": pd.Series([0], dtype="int64"), "SV_apache/2.4.6 (centos) mod_fcgid/2.3.9 php/5.6.30": pd.Series([0], dtype="int64"), "SV_apache/2.4.6 (centos) openssl/1.0.1e-fips": pd.Series([0], dtype="int64"), "SV_apache/2.4.6 (centos) openssl/1.0.1e-fips mod_fcgid/2.3.9 php/5.4.16 mod_jk/1.2.40": pd.Series([0], dtype="int64"), "SV_apache/2.4.6 (centos) openssl/1.0.1e-fips php/5.4.16": pd.Series([0], dtype="int64"), "SV_apache/2.4.6 (centos) openssl/1.0.1e-fips php/5.4.16 mod_apreq2-20090110/2.8.0 mod_perl/2.0.10 perl/v5.24.1": pd.Series([0], dtype="int64"), "SV_apache/2.4.6 (centos) openssl/1.0.1e-fips php/5.5.38": pd.Series([0], dtype="int64"), "SV_apache/2.4.6 (centos) openssl/1.0.1e-fips php/7.0.14": pd.Series([0], dtype="int64"), "SV_apache/2.4.6 (centos) php/5.6.8": pd.Series([0], dtype="int64"), "SV_apache/2.4.6 (red hat enterprise linux) openssl/1.0.1e-fips mod_fcgid/2.3.9 communique/4.2.0": pd.Series([0], dtype="int64"), "SV_apache/2.4.6 (unix) mod_jk/1.2.37": pd.Series([0], dtype="int64"), "SV_apache/2.4.6 (unix) mod_jk/1.2.37 php/5.5.1 openssl/1.0.1g mod_fcgid/2.3.9": pd.Series([0], dtype="int64"), "SV_apache/2.4.7 (ubuntu)": pd.Series([0], dtype="int64"), "SV_apache/not telling (unix) authtds/1.1": pd.Series([0], dtype="int64"), "SV_application-server": pd.Series([0], dtype="int64"), "SV_ats": pd.Series([0], dtype="int64"), "SV_ats/5.3.0": pd.Series([0], dtype="int64"), "SV_barista/5.1.3": pd.Series([0], dtype="int64"), "SV_boston.com frontend": pd.Series([0], dtype="int64"), "SV_cherrypy/3.6.0": pd.Series([0], dtype="int64"), "SV_cloudflare-nginx": pd.Series([0], dtype="int64"), "SV_cowboy": pd.Series([0], dtype="int64"), "SV_dms/1.0.42": pd.Series([0], dtype="int64"), "SV_dosarrest": pd.Series([0], dtype="int64"), "SV_dps/1.1.8": pd.Series([0], dtype="int64"), "SV_ebay server": pd.Series([0], dtype="int64"), "SV_ecd (fll/0790)": pd.Series([0], dtype="int64"), "SV_fbs": pd.Series([0], dtype="int64"), "SV_gse": pd.Series([0], dtype="int64"), "SV_gunicorn/19.7.1": pd.Series([0], dtype="int64"), "SV_heptu web server": pd.Series([0], dtype="int64"), "SV_httpdaemon": pd.Series([0], dtype="int64"), "SV_ideawebserver/v0.80": pd.Series([0], dtype="int64"), "SV_jetty(9.0.z-snapshot)": pd.Series([0], dtype="int64"), "SV_khl": pd.Series([0], dtype="int64"), "SV_lighttpd": pd.Series([0], dtype="int64"), "SV_lighttpd/1.4.28": pd.Series([0], dtype="int64"), "SV_litespeed": pd.Series([0], dtype="int64"), "SV_marrakesh 1.12.2": pd.Series([0], dtype="int64"), "SV_mediafire": pd.Series([0], dtype="int64"), "SV_mi": pd.Series([0], dtype="int64"), "SV_microsoft-httpapi/2.0": pd.Series([0], dtype="int64"), "SV_microsoft-iis/6.0": pd.Series([0], dtype="int64"), "SV_microsoft-iis/7.0": pd.Series([0], dtype="int64"), "SV_microsoft-iis/7.5": pd.Series([0], dtype="int64"), "SV_microsoft-iis/7.5; litigation_essentials.lexisnexis.com  9999": pd.Series([0], dtype="int64"), "SV_microsoft-iis/8.0": pd.Series([0], dtype="int64"), "SV_microsoft-iis/8.5": pd.Series([0], dtype="int64"), "SV_mw2097.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2101.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2103.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2104.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2106.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2107.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2109.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2110.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2113.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2114.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2164.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2165.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2171.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2172.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2173.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2175.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2176.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2177.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2178.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2180.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2182.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2185.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2187.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2190.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2192.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2197.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2198.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2199.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2224.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2225.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2226.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2228.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2230.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2231.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2232.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2233.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2236.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2238.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2239.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2240.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2241.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2242.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2255.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2257.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_mw2260.codfw.wmnet": pd.Series([0], dtype="int64"), "SV_my arse": pd.Series([0], dtype="int64"), "SV_na": pd.Series([0], dtype="int64"), "SV_nginx": pd.Series([0], dtype="int64"), "SV_nginx (openbsd)": pd.Series([0], dtype="int64"), "SV_nginx + phusion passenger": pd.Series([0], dtype="int64"), "SV_nginx/0.7.65": pd.Series([0], dtype="int64"), "SV_nginx/0.8.35": pd.Series([0], dtype="int64"), "SV_nginx/0.8.38": pd.Series([0], dtype="int64"), "SV_nginx/0.8.54": pd.Series([0], dtype="int64"), "SV_nginx/0.8.55": pd.Series([0], dtype="int64"), "SV_nginx/1.1.19": pd.Series([0], dtype="int64"), "SV_nginx/1.10.0": pd.Series([0], dtype="int64"), "SV_nginx/1.10.0 (ubuntu)": pd.Series([0], dtype="int64"), "SV_nginx/1.10.1": pd.Series([0], dtype="int64"), "SV_nginx/1.10.1 + phusion passenger 5.0.30": pd.Series([0], dtype="int64"), "SV_nginx/1.10.2": pd.Series([0], dtype="int64"), "SV_nginx/1.10.3": pd.Series([0], dtype="int64"), "SV_nginx/1.11.10": pd.Series([0], dtype="int64"), "SV_nginx/1.11.2": pd.Series([0], dtype="int64"), "SV_nginx/1.11.3": pd.Series([0], dtype="int64"), "SV_nginx/1.12.0": pd.Series([0], dtype="int64"), "SV_nginx/1.13.0": pd.Series([0], dtype="int64"), "SV_nginx/1.2.1": pd.Series([0], dtype="int64"), "SV_nginx/1.2.6": pd.Series([0], dtype="int64"), "SV_nginx/1.4.3": pd.Series([0], dtype="int64"), "SV_nginx/1.4.4": pd.Series([0], dtype="int64"), "SV_nginx/1.4.6 (ubuntu)": pd.Series([0], dtype="int64"), "SV_nginx/1.6.2": pd.Series([0], dtype="int64"), "SV_nginx/1.6.3": pd.Series([0], dtype="int64"), "SV_nginx/1.6.3 + phusion passenger": pd.Series([0], dtype="int64"), "SV_nginx/1.7.12": pd.Series([0], dtype="int64"), "SV_nginx/1.7.4": pd.Series([0], dtype="int64"), "SV_nginx/1.8.0": pd.Series([0], dtype="int64"), "SV_nginx/1.8.1": pd.Series([0], dtype="int64"), "SV_nginx/1.9.13": pd.Series([0], dtype="int64"), "SV_none": pd.Series([0], dtype="int64"), "SV_nxfps": pd.Series([0], dtype="int64"), "SV_openresty": pd.Series([0], dtype="int64"), "SV_openresty/1.11.2.1": pd.Series([0], dtype="int64"), "SV_openresty/1.11.2.2": pd.Series([0], dtype="int64"), "SV_oracle-iplanet-web-server/7.0": pd.Series([0], dtype="int64"), "SV_pagely gateway/1.5.1": pd.Series([0], dtype="int64"), "SV_pepyaka/1.11.3": pd.Series([0], dtype="int64"), "SV_pizza/pepperoni": pd.Series([0], dtype="int64"), "SV_play": pd.Series([0], dtype="int64"), "SV_proxy pandeiro uol": pd.Series([0], dtype="int64"), "SV_pws/8.2.0.7": pd.Series([0], dtype="int64"), "SV_resin/3.1.8": pd.Series([0], dtype="int64"), "SV_roxen/5.4.98-r2": pd.Series([0], dtype="int64"), "SV_scratch web server": pd.Series([0], dtype="int64"), "SV_server": pd.Series([0], dtype="int64"), "SV_squeegit/1.2.5 (3_sir)": pd.Series([0], dtype="int64"), "SV_squid/3.3.8": pd.Series([0], dtype="int64"), "SV_ssws": pd.Series([0], dtype="int64"), "SV_sucuri/cloudproxy": pd.Series([0], dtype="int64"), "SV_sun-one-web-server/6.1": pd.Series([0], dtype="int64"), "SV_tengine": pd.Series([0], dtype="int64"), "SV_tsa_c": pd.Series([0], dtype="int64"), "SV_varnish": pd.Series([0], dtype="int64"), "SV_virtuoso/07.20.3217 (linux) i686-generic-linux-glibc212-64  vdb": pd.Series([0], dtype="int64"), "SV_www.lexisnexis.com  9999": pd.Series([0], dtype="int64"), "SV_xxxxxxxxxxxxxxxxxxxxxx": pd.Series([0], dtype="int64"), "SV_yippee-ki-yay": pd.Series([0], dtype="int64"), "SV_youtubefrontend": pd.Series([0], dtype="int64"), "SV_zope/(2.13.16; python 2.6.8; linux2) zserver/1.1": pd.Series([0], dtype="int64"), "WC_[u'gb'; u'uk']": pd.Series([0], dtype="int64"), "WC_ae": pd.Series([0], dtype="int64"), "WC_at": pd.Series([0], dtype="int64"), "WC_au": pd.Series([0], dtype="int64"), "WC_be": pd.Series([0], dtype="int64"), "WC_br": pd.Series([0], dtype="int64"), "WC_bs": pd.Series([0], dtype="int64"), "WC_by": pd.Series([0], dtype="int64"), "WC_ca": pd.Series([0], dtype="int64"), "WC_ch": pd.Series([0], dtype="int64"), "WC_cn": pd.Series([0], dtype="int64"), "WC_cyprus": pd.Series([0], dtype="int64"), "WC_cz": pd.Series([0], dtype="int64"), "WC_de": pd.Series([0], dtype="int64"), "WC_es": pd.Series([0], dtype="int64"), "WC_fr": pd.Series([0], dtype="int64"), "WC_gb": pd.Series([0], dtype="int64"), "WC_hk": pd.Series([0], dtype="int64"), "WC_ie": pd.Series([0], dtype="int64"), "WC_il": pd.Series([0], dtype="int64"), "WC_in": pd.Series([0], dtype="int64"), "WC_it": pd.Series([0], dtype="int64"), "WC_jp": pd.Series([0], dtype="int64"), "WC_kg": pd.Series([0], dtype="int64"), "WC_kr": pd.Series([0], dtype="int64"), "WC_ky": pd.Series([0], dtype="int64"), "WC_lu": pd.Series([0], dtype="int64"), "WC_lv": pd.Series([0], dtype="int64"), "WC_nl": pd.Series([0], dtype="int64"), "WC_no": pd.Series([0], dtype="int64"), "WC_none": pd.Series([0], dtype="int64"), "WC_pa": pd.Series([0], dtype="int64"), "WC_ph": pd.Series([0], dtype="int64"), "WC_pk": pd.Series([0], dtype="int64"), "WC_ru": pd.Series([0], dtype="int64"), "WC_sc": pd.Series([0], dtype="int64"), "WC_se": pd.Series([0], dtype="int64"), "WC_si": pd.Series([0], dtype="int64"), "WC_th": pd.Series([0], dtype="int64"), "WC_tr": pd.Series([0], dtype="int64"), "WC_ua": pd.Series([0], dtype="int64"), "WC_ug": pd.Series([0], dtype="int64"), "WC_uk": pd.Series([0], dtype="int64"), "WC_united kingdom": pd.Series([0], dtype="int64"), "WC_us": pd.Series([0], dtype="int64"), "WC_uy": pd.Series([0], dtype="int64"), "WS_-": pd.Series([0], dtype="int64"), "WS_--": pd.Series([0], dtype="int64"), "WS_6110021": pd.Series([0], dtype="int64"), "WS_ab": pd.Series([0], dtype="int64"), "WS_ak": pd.Series([0], dtype="int64"), "WS_al": pd.Series([0], dtype="int64"), "WS_alabama": pd.Series([0], dtype="int64"), "WS_alberta": pd.Series([0], dtype="int64"), "WS_alicante": pd.Series([0], dtype="int64"), "WS_andhra pradesh": pd.Series([0], dtype="int64"), "WS_antwerp": pd.Series([0], dtype="int64"), "WS_arizona": pd.Series([0], dtype="int64"), "WS_arkansas": pd.Series([0], dtype="int64"), "WS_austria": pd.Series([0], dtype="int64"), "WS_az": pd.Series([0], dtype="int64"), "WS_bangkok": pd.Series([0], dtype="int64"), "WS_barcelona": pd.Series([0], dtype="int64"), "WS_bc": pd.Series([0], dtype="int64"), "WS_bei jing": pd.Series([0], dtype="int64"), "WS_beijingshi": pd.Series([0], dtype="int64"), "WS_berlin": pd.Series([0], dtype="int64"), "WS_british columbia": pd.Series([0], dtype="int64"), "WS_ca": pd.Series([0], dtype="int64"), "WS_california": pd.Series([0], dtype="int64"), "WS_central": pd.Series([0], dtype="int64"), "WS_ch": pd.Series([0], dtype="int64"), "WS_co": pd.Series([0], dtype="int64"), "WS_co. dublin": pd.Series([0], dtype="int64"), "WS_colorado": pd.Series([0], dtype="int64"), "WS_connecticut": pd.Series([0], dtype="int64"), "WS_ct": pd.Series([0], dtype="int64"), "WS_dc": pd.Series([0], dtype="int64"), "WS_de": pd.Series([0], dtype="int64"), "WS_district of columbia": pd.Series([0], dtype="int64"), "WS_dubai": pd.Series([0], dtype="int64"), "WS_fl": pd.Series([0], dtype="int64"), "WS_florida": pd.Series([0], dtype="int64"), "WS_fukuoka": pd.Series([0], dtype="int64"), "WS_ga": pd.Series([0], dtype="int64"), "WS_grand cayman": pd.Series([0], dtype="int64"), "WS_greater london": pd.Series([0], dtype="int64"), "WS_hants": pd.Series([0], dtype="int64"), "WS_haryana": pd.Series([0], dtype="int64"), "WS_hr": pd.Series([0], dtype="int64"), "WS_hunansheng": pd.Series([0], dtype="int64"), "WS_il": pd.Series([0], dtype="int64"), "WS_illinois": pd.Series([0], dtype="int64"), "WS_ilocos norte r3": pd.Series([0], dtype="int64"), "WS_indal": pd.Series([0], dtype="int64"), "WS_indiana": pd.Series([0], dtype="int64"), "WS_kansas": pd.Series([0], dtype="int64"), "WS_karnataka": pd.Series([0], dtype="int64"), "WS_kentucky": pd.Series([0], dtype="int64"), "WS_kg": pd.Series([0], dtype="int64"), "WS_kireka": pd.Series([0], dtype="int64"), "WS_krasnoyarsk": pd.Series([0], dtype="int64"), "WS_ks": pd.Series([0], dtype="int64"), "WS_la": pd.Series([0], dtype="int64"), "WS_liaoningsheng": pd.Series([0], dtype="int64"), "WS_london": pd.Series([0], dtype="int64"), "WS_ma": pd.Series([0], dtype="int64"), "WS_maharashtr": pd.Series([0], dtype="int64"), "WS_maharashtra": pd.Series([0], dtype="int64"), "WS_mahe": pd.Series([0], dtype="int64"), "WS_maine": pd.Series([0], dtype="int64"), "WS_manila": pd.Series([0], dtype="int64"), "WS_manitoba": pd.Series([0], dtype="int64"), "WS_maryland": pd.Series([0], dtype="int64"), "WS_massachusetts": pd.Series([0], dtype="int64"), "WS_mb": pd.Series([0], dtype="int64"), "WS_md": pd.Series([0], dtype="int64"), "WS_me": pd.Series([0], dtype="int64"), "WS_metro manila": pd.Series([0], dtype="int64"), "WS_mh": pd.Series([0], dtype="int64"), "WS_mi": pd.Series([0], dtype="int64"), "WS_michigan": pd.Series([0], dtype="int64"), "WS_middlesex": pd.Series([0], dtype="int64"), "WS_minnesota": pd.Series([0], dtype="int64"), "WS_missouri": pd.Series([0], dtype="int64"), "WS_mo": pd.Series([0], dtype="int64"), "WS_montevideo": pd.Series([0], dtype="int64"), "WS_moscow": pd.Series([0], dtype="int64"), "WS_nc": pd.Series([0], dtype="int64"), "WS_nebraska": pd.Series([0], dtype="int64"), "WS_nevada": pd.Series([0], dtype="int64"), "WS_new jersey": pd.Series([0], dtype="int64"), "WS_new mexico": pd.Series([0], dtype="int64"), "WS_new providence": pd.Series([0], dtype="int64"), "WS_new south wales": pd.Series([0], dtype="int64"), "WS_new york": pd.Series([0], dtype="int64"), "WS_nh": pd.Series([0], dtype="int64"), "WS_nj": pd.Series([0], dtype="int64"), "WS_none": pd.Series([0], dtype="int64"), "WS_noord-holland": pd.Series([0], dtype="int64"), "WS_north carolina": pd.Series([0], dtype="int64"), "WS_not applicable": pd.Series([0], dtype="int64"), "WS_novosibirskaya obl.": pd.Series([0], dtype="int64"), "WS_nsw": pd.Series([0], dtype="int64"), "WS_nv": pd.Series([0], dtype="int64"), "WS_ny": pd.Series([0], dtype="int64"), "WS_oh": pd.Series([0], dtype="int64"), "WS_ohio": pd.Series([0], dtype="int64"), "WS_ok": pd.Series([0], dtype="int64"), "WS_on": pd.Series([0], dtype="int64"), "WS_ontario": pd.Series([0], dtype="int64"), "WS_or": pd.Series([0], dtype="int64"), "WS_oregon": pd.Series([0], dtype="int64"), "WS_osaka": pd.Series([0], dtype="int64"), "WS_other": pd.Series([0], dtype="int64"), "WS_p": pd.Series([0], dtype="int64"), "WS_pa": pd.Series([0], dtype="int64"), "WS_panama": pd.Series([0], dtype="int64"), "WS_paris": pd.Series([0], dtype="int64"), "WS_pennsylvania": pd.Series([0], dtype="int64"), "WS_peterborough": pd.Series([0], dtype="int64"), "WS_praha": pd.Series([0], dtype="int64"), "WS_punjab": pd.Series([0], dtype="int64"), "WS_qc": pd.Series([0], dtype="int64"), "WS_qld": pd.Series([0], dtype="int64"), "WS_quebec": pd.Series([0], dtype="int64"), "WS_queensland": pd.Series([0], dtype="int64"), "WS_rix": pd.Series([0], dtype="int64"), "WS_rm": pd.Series([0], dtype="int64"), "WS_rogaland": pd.Series([0], dtype="int64"), "WS_saskatchewan": pd.Series([0], dtype="int64"), "WS_shandong": pd.Series([0], dtype="int64"), "WS_sk": pd.Series([0], dtype="int64"), "WS_south carolina": pd.Series([0], dtype="int64"), "WS_tamil nadu": pd.Series([0], dtype="int64"), "WS_tennessee": pd.Series([0], dtype="int64"), "WS_texas": pd.Series([0], dtype="int64"), "WS_tn": pd.Series([0], dtype="int64"), "WS_tokyo-to": pd.Series([0], dtype="int64"), "WS_tottori": pd.Series([0], dtype="int64"), "WS_tr": pd.Series([0], dtype="int64"), "WS_tx": pd.Series([0], dtype="int64"), "WS_uk": pd.Series([0], dtype="int64"), "WS_ut": pd.Series([0], dtype="int64"), "WS_utah": pd.Series([0], dtype="int64"), "WS_utr": pd.Series([0], dtype="int64"), "WS_uttar pradesh": pd.Series([0], dtype="int64"), "WS_va": pd.Series([0], dtype="int64"), "WS_vermont": pd.Series([0], dtype="int64"), "WS_vi": pd.Series([0], dtype="int64"), "WS_vic": pd.Series([0], dtype="int64"), "WS_virginia": pd.Series([0], dtype="int64"), "WS_vt": pd.Series([0], dtype="int64"), "WS_wa": pd.Series([0], dtype="int64"), "WS_washington": pd.Series([0], dtype="int64"), "WS_wc1n": pd.Series([0], dtype="int64"), "WS_west midlands": pd.Series([0], dtype="int64"), "WS_wi": pd.Series([0], dtype="int64"), "WS_widestep@mail.ru": pd.Series([0], dtype="int64"), "WS_wisconsin": pd.Series([0], dtype="int64"), "WS_worcs": pd.Series([0], dtype="int64"), "WS_wv": pd.Series([0], dtype="int64"), "WS_zh": pd.Series([0], dtype="int64"), "WS_zhejiang": pd.Series([0], dtype="int64"), "WS_zug": pd.Series([0], dtype="int64")})
output_sample = np.array([0])
try:
    log_server.enable_telemetry(INSTRUMENTATION_KEY)
    log_server.set_verbosity('INFO')
    logger = logging.getLogger('azureml.automl.core.scoring_script')
except:
    pass


def init():
    global model
    # This name is model.id of model that we want to deploy deserialize the model file back
    # into a sklearn model
    model_path = os.path.join(os.getenv('AZUREML_MODEL_DIR'), 'model.pkl')
    path = os.path.normpath(model_path)
    path_split = path.split(os.sep)
    log_server.update_custom_dimensions({'model_name': path_split[-3], 'model_version': path_split[-2]})
    try:
        logger.info("Loading model from path.")
        model = joblib.load(model_path)
        logger.info("Loading successful.")
    except Exception as e:
        logging_utilities.log_traceback(e, logger)
        raise


@input_schema('data', PandasParameterType(input_sample))
@output_schema(NumpyParameterType(output_sample))
def run(data):
    try:
        result = model.predict(data)
        return json.dumps({"result": result.tolist()})
    except Exception as e:
        result = str(e)
        return json.dumps({"error": result})
